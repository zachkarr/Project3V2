<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org">
<body>
<link href="https://cdnjs.cloudflare.com/ajax/libs/jquery-toast-plugin/1.3.2/jquery.toast.min.css" rel="stylesheet" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-toast-plugin/1.3.2/jquery.toast.min.js"></script>

<script th:inline="javascript">

$(document).ready( function() {
	if([[${message}]]) {
		let jsonObj = JSON.parse([[${message}]]);
		
		$.toast({
			heading : "Success",
			hideAfter : 10000, 
			text: 'Sucess. Your Incident number is: ' + jsonObj.result.number,
			position : "top-center",
			icon : "success",
			loader : true,
			loaderBg : "#9EC600"
		});
	}
	
});
function exportIncidentsToExcel() {
window.location.href = "/exportAllIncidents";

}
</script>


<h1>Report Incident</h1>
<form action="#" th:action="@{/submitIncident}" method="post">

<div sec:authorize="hasRole('ROLE_USER')">
<textarea th:value="${txtArea}" rows="10" cols="50" id="is296" name="is296"></textarea>
<input type="submit" value="Submit" />
</div>
<div th:if="${message}" th:text="${message}"></div>
</form>
<button onclick="exportIncidentsToExcel()">Export All Incidents to Excel</button>
</body>

</html>